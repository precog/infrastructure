# Generated by Chef
# host definitions

define host {
  use server
  address 173.192.117.238
  host_name api.reportgrid.com
  hostgroups reportgrid_api
}

<% @nodes.each do |n| 
  # Total hack to exclude Arbiters based on a marker role
  if n.role?("mongodb-arbiter") then
    allroles = "default"
  else
    allroles = n.run_list.roles.to_a.join(",")
  end
-%>
define host {
  use server
  address <%= n['ipaddress'] %>
  host_name <%= n['hostname'] %>
<% if n.run_list.roles.nil? || n.run_list.roles.length == 0 -%>
  hostgroups all
<% else -%>
  hostgroups <%= allroles %>
<% end -%>
}

<% end -%>


